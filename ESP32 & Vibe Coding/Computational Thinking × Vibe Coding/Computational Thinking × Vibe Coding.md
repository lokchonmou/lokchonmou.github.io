# Computational Thinking × Vibe Coding

> 範例：**ESP32 使用超聲波感測器測距，並於 OLED 顯示距離**

## 0. 專案總覽

| 區塊                    | 內容                                                         |
| ----------------------- | ------------------------------------------------------------ |
| **產品目標**            | 以 ESP32 量測距離並在 OLED 顯示，每 200ms 更新；距離 < 1.5cm 時顯示「⚠️ Too Close」。 |
| **I/O 定義**            | **輸入**：超聲波回波時間（us）→ 換算距離（cm）。**輸出**：OLED 128×64 文本/數值。 |
| **限制條件**            | 單一專案（多檔可）；以 Arduino Core for ESP32；以 `millis()` 做節流；避免阻塞式 `delay()`。 |
| **驗收標準**            | 1. 正常距離 5–200cm 量測誤差 ≤ ±2cm；<br />2. 200ms 內完成一次更新；<br />3. <1.5cm 觸發警示；<br />4. 感測異常時顯示 `—`；<br />5. 程式含清晰註解並列出授權資訊。 |
| **子系統**              | 1. 超聲波測距；<br />2. OLED 顯示；<br />                    |
| **資料流圖**/**時序圖** | <img src="%E8%9E%A2%E5%B9%95%E6%88%AA%E5%9C%96%202025-10-14%2014.53.16.png" alt="螢幕截圖 2025-10-14 14.53.16" style="width:50%;" /> |

## 1. 子系統 A：超聲波測距

### 1.1 PRD（感測子系統）

| 區塊         | 內容                                                         |
| ------------ | ------------------------------------------------------------ |
| **產品目標** | 以超聲波模組量測距離（cm），提供穩定、去雜訊的數值。         |
| **I/O 定義** | **輸入**：`Trigger` 腳（輸出脈衝）、`Echo` 腳（量測高電平時間）。**輸出**：距離（float, cm）。 |
| **限制條件** | 以 `millis()` 控制觸發頻率（≥200ms 間隔），避免連續觸發；提供 3~5 次移動平均去抖動； |
| **驗收標準** | 1) 10/50/100cm 標定誤差 ≤ ±1cm；2) No reading 時回傳 `NAN`；3) 量測頻率可配置（預設 5Hz）。 |

### 1.2 結構化 Prompt（交給 AI 生成「感測器驅動」）

> 你是嵌入式工程師。請為 ESP32（Arduino Core） 生成一個 超聲波測距模組 的程式檔（請用單一ino檔）。 
>
> I/O：`TRIG_PIN=5`、`ECHO_PIN=18` 
>
> 需求： 
>
> - 每 ≥200ms 觸發一次量測，回傳距離（cm，float）。 
>
> - 以 5 筆移動平均平滑化；量測失敗回`NAN`。 
>
> - 不使用 `delay()`；用 `millis()` 節流。 
>
> - 提供 `readDistance()` 函式；失敗時列印錯誤碼。 
>
> - 不要做用外部library
>
> 驗收： 
>
> 1. 含註解與簡單測試 selfTest()，在序列埠列印 10 次讀值。 
> 2. 量測頻率可配置（預設 5Hz）。

[Gemini 生成](https://g.co/gemini/share/026463036295)

## 2. 子系統 B：OLED 顯示

### 	2.1 PRD（顯示子系統）

| 區塊         | 內容                                                         |
| ------------ | ------------------------------------------------------------ |
| **產品目標** | 以 I²C OLED（128×64）穩定顯示數值與警示訊息。                |
| **I/O 定義** | **輸入**：距離（float 或字串）、狀態（正常/警示/無數據）。**輸出**：視覺呈現。 |
| **限制條件** | 以 `millis()` 限制刷新頻率（≥100ms）；避免連續重畫耗電；使用通用字型；單一初始化流程。 |
| **驗收標準** | 1) 正常顯示距離，字元不重疊；2) 無數據顯示 `—`；3) 警示狀態以反白或符號顯示；4) 刷新順暢無閃爍。 |

### 2.2 結構化 Prompt（交給 AI 生成「顯示模組」）

> 你是嵌入式工程師。請為 **ESP32 (Arduino Core)+ I²C OLED(128×64)** 生成顯示模組。
>  **需求**：
>
> - 提供 `displayDistance(float d)`、`displayWarning()`、`displayNoData()` 三個 function。
>
> - 使用Adafruit 的 SSD1306 library，並在程式碼中注解說明如何安裝。
>
> - 以 `millis()` 節流，避免>10Hz 的不必要重畫。
>
> - 初始化、字型設定、清屏流程請封裝於 `initDisplay()`。
>
> - 程式含註解、含簡單 `selfTest()`（輪流顯示三種狀態）。
>
> 	**驗收**：反覆呼叫 API 不應造成殘影或閃爍。

- 使用同一個AI對話框繼續的話，可以不需要提醒`你是嵌入式工程師。`和`請為ESP32 (Arduino Core)生成...`，反而要提醒AI，要獨立測驗OLED顯示模組。
- AI做得正確時，不妨讚賞一下，那在連續對話中，它才知道要答甚麼才是正確。
- ==核對一下ESP32的I²C腳位是否正確，尤其是如果你用較舊的AI工具，十分容易出現幻覺。==
- 後來生成的程式碼有2個問題，我都請AI幫我修正和手動修正:
	- Adafruit SSD1306 library不支援中文
	- 文字太大以致換行

[Gemini生成](https://g.co/gemini/share/afe18a09c322)

## 3. 系統層 PRD

### 3.1 結構化 Prompt（交給 AI 生成「整合主檔」）

> 你是嵌入式架構師。請基於ESP32(Arduino Core)生成 **`.ino`**檔，整合前述兩個模組（感測 + 顯示）。
>  **需求**：
>
> - 超聲波測量:
>
> 	- 每 200ms 觸發一次量測
> 	- 以 5 筆移動平均平滑化；量測失敗回`NAN`。 
>
> 	- 不使用 `delay()`；用 `millis()` 節流。 
>
> 	- 提供 `readDistance()` 函式；失敗時列印錯誤碼。 
>
> 	- 超聲波不要做用外部library
>
> - I²C OLED(128×64)
> 	- 提供 `displayDistance(float d)`、`displayWarning()`、`displayNoData()` 三個 function。
> 	- 使用Adafruit 的 SSD1306 library，並在程式碼中注解說明如何安裝。
> 	- 以 `millis()` 節流，避免>10Hz 的不必要重畫。
> 	- 初始化、字型設定、清屏流程請封裝於 `initDisplay()`。
> - 整合:
> 	- 距離 < 1.5cm 時顯示「Too Close」
> 	- 感測異常時顯示 `—`
> 	- 程式含清晰註解並列出授權資訊

[Gemini生成](https://g.co/gemini/share/eaa059c64133)

## 4. 工作紙與評核

1. [Computational Thinking × Vibe Coding worksheet(電子填寫和提交)]( Computational Thinking × Vibe Coding worksheet.docx)

2. [🧮 AI 協作編程評分量表（Vibe Coding × 運算思維整合）.pdf](🧮 AI 協作編程評分量表（Vibe Coding × 運算思維整合）.pdf)  

3. [AI 協作編程反思與自檢表(實體填寫提交)](AI 協作編程反思與自檢表.pdf) 